<div>
{% if communities.denied %}
<h3> {{ communities.denied }} </h3> 
{% else %}

<h2> Management functions </h2>
{{ communities.message }}

<h3>Communities joined</h3> 

{% if communities.joined %}
  <div class="table-wrapper-scroll-y my-custom-scrollbar"> 
  <table> 
  <thead
     position: sticky;
     top:0>
    <tr>
      <th> Community Name </th>
      <th> Leave </th>
    </tr>
  </thead>
  <tbody> 
  {% for c in communities.joined %}
      <tr>
      <td> {{ c.name }} </td> 
      <td> <button type="button" id="Leave" 
              onclick="group_leave_community({{ gid }}, {{ c.id }})" > 
              Leave </button> 
      </td>
      </tr>
  {% endfor %}
  </tbody>
  </table>
  </div> 
{% else %}
   <p><em>There are no community memberships at present. </em></p> 
{% endif %}

<h3>Community invitations</h3> 
{% if communities.approvals %}
  <div class="table-wrapper-scroll-y my-custom-scrollbar"> 
  <table> 
  <thead
     position: sticky;
     top:0>
    <tr>
      <th> Community Name </th>
      <th> Community Owner </th>
      <th> Date </th>
      <th> Approve </th>
      <th> Decline  </th>
    </tr>
  </thead>
  <tbody> 
  {% for gcr in communities.approvals %}
      <tr>
      <td> {{ gcr.community.name }} </td> 
      <td> {{ gcr.community_owner.username }} </td>
      <td> {{ gcr.when_community }} </td>
      <td> <button type="button" id="Approve" 
              onclick="group_approve_community_invite({{ gid }}, {{ gcr.community.id }})" > 
              approve </button> 
      </td>
      <td> <button type="button" id="Decline" 
              onclick="group_decline_community_invite({{ gid }}, {{ gcr.community.id }})"> 
              decline </button>
      </td>
      </tr>
  {% endfor %}
  </tbody>
  </table>
  </div> 
{% else %}
   <p><em>There are no community invitations at present. </em></p> 
{% endif %}

<h3> Request to join a community </h3> 
{% if communities.communities %}
  <div class="table-wrapper-scroll-y my-custom-scrollbar"> 
  <table> 
  <thead
     position: sticky;
     top:0>
    <tr>
      <th> Community Name </th>
      <th> Join  </th>
    </tr>
  </thead>
  <tbody> 
  {% for c in communities.communities %}
      <tr>
      <td> {{ c.name }} </td> 
      <td> <button type="button" id="Join" 
              onclick="group_join_community({{ gid }}, {{ c.id }})" > 
              Join </button> 
      </td>
      </tr>
  {% endfor %}
  </tbody>
  </table>
  </div> 
{% else %}
  <p><em>There are no communities to join at present.</em></p> 
{% endif %}

<h3> Pending requests </h3> 
{% if pending %}
  <div class="table-wrapper-scroll-y my-custom-scrollbar"> 
  <table> 
  <thead
     position: sticky;
     top:0>
    <tr>
      <th> Community Name </th>
      <th> Date </th>
      <th> Retract  </th>
    </tr>
  </thead>
  <tbody> 
  {% for gcr in communities.pending %}
      <tr>
      <td> {{ gcr.community.name }} </td> 
      <td> {{ gcr.when_group }} </td>
      <td> <button type="button" id="Retract" 
              onclick="group_retract_community_request({{ gid }}, {{ gcr.community.id }})" > 
              Retract </button> 
      </td>
      </tr>
  {% endfor %}
  </tbody>
  </table>
  </div> 
{% else %}
   <p><em>There are no pending requests at present. </em></p> 
{% endif %}

<h3> Requests we declined </h3> 

{% if communities.we_declined %}
    <div class="table-wrapper-scroll-y my-custom-scrollbar">
    <table>
      <thead
         position: sticky;
         top:0>
        <tr>
          <th> Community </th>
          <th> Community Owner </th>
          <th> Group Owner </th>
          <th> When </th>
          <th> Approve </th>
        </tr>
      </thead>
      <tbody> 
    {% for gcr in communities.we_declined %}
    <tr>
    <td> {{ gcr.community.name }} </td>
    <td> {{ gcr.community_owner.username }} </td>
    <td> {{ gcr.group_owner.username }} </td>
    <td> {{ gcr.when_group }} </td>
    <td> <button type="button" id="Approve" 
            onclick="group_approve_community_invite({{ gid }}, {{ gcr.community.id }})" > 
            Approve </button> 
    </td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div> 

{% else %}
    <p><em> We haven't declined any requests yet. </em></p> 
{% endif %}

<h3> Invitations that communities declined</h3> 

{% if communities.they_declined %}
    <div class="table-wrapper-scroll-y my-custom-scrollbar">
    <table>
      <thead
         position: sticky;
         top:0>
        <tr>
          <th> Community </th>
          <th> Community Owner </th>
          <th> Group Owner</th>
          <th> When </th>
        </tr>
      </thead>
      <tbody> 
    {% for gcr in communities.they_declined %}
    <tr>
    <td> {{ gcr.community.name }} </td>
    <td> {{ gcr.community_owner.username }} </td>
    <td> {{ gcr.group_owner.username }} </td>
    <td> {{ gcr.when_community }} </td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    </div> 
{% else %}
    <p><em> Others haven't declined any requests yet. </em></p> 
{% endif %}

{% endif %}
</div>
