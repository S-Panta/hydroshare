{% extends "pages/page.html" %}

{% load hydroshare_tags %}

{% block meta_title %}My Communities {% endblock %}

{% block main %}
    <div class="collaborate-header">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="collaborate-nav">
                        <a href="{% url "communities" %}" class="collaborate-nav-item">Find Communities</a>
                        <a href="{% url "my_communities" %}" class="collaborate-nav-item active">My Communities</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h2 class="page-title">My Communities</h2>
            </div>
            <div class="col-sm-3">
                <a class="btn btn-success" data-toggle="modal" data-target="#request-new-community-dialog">
                    <i class="fa fa-plus"></i> Request a New Community
                </a>
            </div>
            <div class="col-sm-9">
                <div class="row">
                    <div class="col-sm-12">
                        {% if communities_list %}
                            <table class="groups-table">
                                {% for c in communities_list %}
                                    <tr>
                                        <td>
                                            {% if group.gaccess.picture and group.gaccess.picture.url %}
                                                <div class="group-image-wrapper">
                                                    <div class="group-image-small"
                                                         style="background-image: url({{ group.gaccess.picture.url }})"></div>
                                                </div>
                                            {% else %}
                                                <div class="group-image-wrapper">
                                                    <div class="group-image-small"
                                                         style="background-image: url({{ STATIC_URL }}img/home-page/step4.png)"></div>
                                                </div>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <h4><a href="/community/{{ c.id }}">{{ c.name }}</a></h4>
                                            <img src="{{ STATIC_URL }}img/public.png" alt="Public Community"
                                                 title="Public Community">
                                            <small class="text-muted"> Public Community</small>
                                        </td>
                                        <td style="text-align: right"><span>{% if group.is_group_owner %}Owner{% else %}
                                            Member{% endif %}</span></td>
                                    </tr>
                                {% endfor %}
                            </table>
                        {% endif %}
                        {% if not communities_list %}
                            <i>You have not joined any communities.</i>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Request New Community Dialog -->
    <div class="modal fade" id="request-new-community-dialog" tabindex="-1" role="dialog"
         aria-labelledby="Creage Community">
        <div class="modal-dialog" role="document"> 
            <div class="modal-content">
                <form id="request-new-community-form" action="/hsapi/_internal/request-new-community/"
                    method="POST" enctype="multipart/form-data">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"
                                aria-label="Close"><span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title" id="myModalLabel">Request a New Community</h4>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-info">
                            <p>Your can use this form to request creation of a new Community. Community creation requests will be reviewed by CUAHSI. If your request is approved, your new Community will appear in HydroShare and you will be notified.</p>
                        </div>
                        <div  class="row">
                            {% csrf_token %}
                            <!-- Community Name -->
                            <fieldset class="col-sm-12">
                                <label>Community Name *</label>
                                <small class="text-muted">79 characters or less</small>
                                <textarea class="form-control" required="required" name="name" maxlength="79"
                                    placeholder="Descriptive name for the Community"></textarea>
                            </fieldset>

                            <!-- Community Contact Email -->
                            <fieldset class="col-sm-12">
                                <label>Community Contact Email</label>
                                <input type="email" name="email" class="form-control"
                                placeholder="Email address for a person in charge of the Community">
                            </fieldset>

                            <!-- Community Url -->
                            <fieldset class="col-sm-12">
                                <label>Community URL</label>
                                <input type="url" name="url" class="form-control"
                                placeholder="A URL for a web page that describes the Community in more detail">
                            </fieldset>

                            <!-- Purpose -->
                            <fieldset class="col-sm-12">
                                <label>Purpose</label>
                                <small class="text-muted">300 characters or less</small>
                                <textarea class="form-control" name="purpose" maxlength="300"
                                    placeholder="A brief statement of the purpose for the Community"></textarea>
                            </fieldset>

                            <!-- About -->
                            <fieldset class="col-sm-12">
                                <label>About this Community *</label>
                                <textarea class="form-control" name="description" required="required"
                                    placeholder="A longer text description of the Community"></textarea>
                            </fieldset>
                            
                            <br>
                            <fieldset class="col-sm-12">
                                <small class="text-muted">( * ) Required fields</small>
                            </fieldset>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Submit Request</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-formhelpers.js"></script>
{% endblock %}
